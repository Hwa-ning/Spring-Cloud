# Spring Cloud Gateway
## 게이트웨이의 필요성
- 마이크로서비스와 같은 분산형 아키텍처에서는 보안과 로깅, 여러 서비스 호출에 걸친 사용자 추적과 같은 작업이 필요할 시점이 생김
- 각자의 개발팀이 독자적인 솔루션을 구축할 필요없이 모든 서비스에 이러한 특성을 적용하면 편리함
- 공통 라이브러리나 프레임워크를 통해 서비스에 직접 구축은 가능하나 다음과 같은 문제점이 발생할 수 있음
  - 각 서비스의 일관성있는 구현의 어려움
  - 보안과 로깅 같은 횡단 광심사의 구현 책임을 개별 개발팀에 전가하면 잘못된 구현 또는 누락의 발생
  - 모든 서비스에 걸친 강한 의존성 발생
- **횡단 관심사를 독립적으로 배치하고 아키텍처의 모든 호출에 대한 필터와 라우터 역할을 할 수 있는 서비스로 추상화**해야함 -> 게이트웨이

### 서비스 게이트웨이가 없는 상황
- 서비스 클라이언트는 각 서비스의 엔드포인트를 직접 호출해야함 <br>
클라이언트 -> (http://localshot:8080/v1/serviceA) -> A 서비스<br>
클라이언트 -> (http://localshot:8080/v1/serviceB) -> B 서비스<br>

### 서비스 게이트웨이가 있는 상황
- 서비스 게이트웨이는 서비스 클라이언트와 호출되는 서비스 사이에서 중개 역할을 하고, 서비스 게이트웨이가 관리하는 하나의 URL로 통신함.
- 서비스 클라이언트 호출에서 보낸 경로를 분해하고 서비스 클라이언트가 호출하려는 서비스를 결정함

클라이언트 -> (http://localshot:8080/v1/serviceA) -> 게이트웨이 -> A 서비스 <br>
클라이언트 -> (http://localshot:8080/v1/serviceB) -> 게이트웨이 -> B 서비스 <br>

- 서비스 게이트웨이는 애플리케이션 내의 마이크로서비스를 호출하기 위해 유입되는 모든 트래픽의 게이트키퍼 역할을 함.
- 서비스 클라이언트는 URL을 직접 호출하는 방식이 아닌 서비스 게이트웨이에 호출을 보냄

### 서비스 게이트웨이에서 구현 가능한 횡단 관심사
- 정적 라우팅 : 단일 서비스 URL과 API 경로로 모든 서비스를 호출함. 모든 서비스에 대해 하나의 서비스 엔드포인트만 알면 되므로 개발이 편해짐
- 동적 라우팅 : 유입되는 서비스 요청을 검사하고 요청 데이터를 기반으로 서비스 호출자를 위해 지능적 라우팅을 수행함
- 인증과 인가 : 모든 서비스 호출이 서비스 게이트웨이를 통해 라우팅되므로 호출자에 대한 인증 여부를 확인이 가능함
- 지표 수집과 로깅 : 모든 서비스 호출이 서비스 게이트웨이를 통하므로 지표와 로그를 수집하는데 사용할 수 있음

### 현재
service-one : 18091 port <br>
gateway-service 18090 port <br>

기존 service-one 호출 -> localhost:{해당 서비스 port} 호출 <br>
ex) http://localhost:18091/config/message/profile <br>
변경 후 gateway 적용 -> localhost:**{gateway port}**/**{호출하려는 서비스명}**/**{endPoint}** <br>
ex) http://localhost:18090/one/config/message/profile <br>